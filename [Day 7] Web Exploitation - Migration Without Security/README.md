# [Day 7] Web Exploitation - Migration Without Security

## Learning Objectives

1. What is NoSQL?
2. Understanding NoSQL database
3. Understand Why NoSQL happens
4. Understand what NoSQL injection is
5. Using NoSQL Injection to bypass a login form

## Interact with the MongoDB server to find the flag. What is the flag?

We connect to the machine through ssh:
```bash
user@machine$ ssh thm@MACHINE_IP -p 2222
```

We enter the MongoDB shell:
```bash
mongo
```

We show the databases:
```bash
show databases
```

We switch to `flagdb`:
```bash
use flagdb
```

We show the collections:
```
show collections
```

We diplay the documents:
```
db.flagColl.find()
```

Answer:
```
THM{8814a5e6662a9763f7df23ee59d944f9}
```

## Setup and run Burp Suite proxy to intercept the HTTP request for the login page. Then modify the POST parameter.

1. launch Burp Suite
2. Navigate to the "Proxy" tab
3. Press "Intercept On" in "Proxy > Intercept"
4. Click on "Open in Browser" to launch Burp Suite's integrated browser
5. Submit `username`: admin and `password`: admin
6. Return to Burp Suite, where we will see some data has now been returned to us. We will modify the parameters to be like so:
```
username=admin&password[$ne]=admin
```
7. Press "Forward" in "Proxy > Intercept"

We can retrieve the flag by pressing "Flag!"

Answer:
```
THM{b6b304f5d5834a4d089b570840b467a8}
```

## Once you are logged in, use the gift search page to list all usernames that have guest roles. What is the flag?

1. launch Burp Suite
2. Navigate to the "Proxy" tab
3. Press "Intercept On" in "Proxy > Intercept"
4. Click on "Open in Browser" to launch Burp Suite's integrated browser
5. Submit `username`: admin
6. Return to Burp Suite, where we will see some data has now been returned to us. We will modify the parameters to be like so:
```
username[$ne]=admin&role=guest
```
7. Press "Forward" in "Proxy > Intercept"

Answer:
```
THM{2ec099f2d602cc4968c5267970be1326}
```

## Use the gift search page to perform NoSQL injection and retrieve the mcskidy record. What is the details record?

1. launch Burp Suite
2. Navigate to the "Proxy" tab
3. Press "Intercept On" in "Proxy > Intercept"
4. Click on "Open in Browser" to launch Burp Suite's integrated browser
5. Submit `username`: mcskidy
6. Return to Burp Suite, where we will see some data has now been returned to us. We will modify the parameters to be like so:
```
username=mcskidy&role[$ne]=user
```
7. Press "Forward" in "Proxy > Intercept"

Answer:
```
ID:6184f516ef6da50433f100f4:mcskidy:admin
```